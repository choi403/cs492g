# environment variables
f1 = c('change_1_day_change_6_month_high', 'PBR_change_6_month_low', 'PSR_ROE_high', 'PCR_change_3_month_high', 'PER_ROA_low', 'change_1_month_change_3_month_low', 'change_1_week_change_6_month_high', 'PSR_PCR_high', 'PBR_NCAV_high', 'change_1_month_ROA_low', 'change_1_month_change_6_month_high', 'change_1_month_PBR_high', 'PBR_change_3_month_high', 'change_1_day_NCAV_low', 'PSR_NCAV_low', 'PBR_GPA_high', 'change_1_day_GPA_high', 'change_1_week_ROA_high', 'PER_change_12_month_high', 'PER_PSR_low', 'PSR_ROA_low', 'change_1_day_ROA_low', 'change_1_week_NCAV_high', 'change_1_day_change_1_month_high', 'change_1_day_PER_high', 'ROE_NCAV_high', 'PSR_change_12_month_low', 'change_1_day_ROE_low', 'change_1_month_change_12_month_low', 'PER_NCAV_low', 'PCR_change_12_month_low', 'PSR_change_12_month_high', 'change_1_day_change_3_month_low', 'change_1_day_PCR_low', 'GPA_change_3_month_high', 'PCR_change_6_month_low', 'PSR_GPA_high', 'ROE_change_3_month_high', 'change_1_week_PCR_low', 'change_1_day_PSR_high', 'change_1_month_NCAV_high') 
f2 = c('PER_change_12_month_low', 'PSR_NCAV_high', 'change_1_month_change_6_month_low', 'change_1_week_ROE_low', 'PER_GPA_high', 'change_1_week_ROE_high', 'GPA_change_12_month_low', 'PER_PCR_low', 'PBR_ROA_low', 'PBR_change_3_month_low', 'GPA_change_6_month_low', 'PSR_PBR_low', 'PBR_NCAV_low', 'PCR_ROA_low', 'PBR_GPA_low', 'change_1_week_GPA_high', 'change_1_week_change_1_month_high', 'change_1_week_ROA_low', 'PCR_NCAV_low', 'PSR_PBR_high', 'change_1_week_NCAV_low', 'change_1_week_change_3_month_low', 'change_1_day_change_12_month_low', 'GPA_change_12_month_high', 'PCR_change_12_month_high', 'change_1_day_change_1_month_low', 'change_1_day_change_3_month_high', 'change_1_day_PBR_low', 'PCR_ROE_high', 'ROE_change_6_month_high', 'change_1_day_change_12_month_high', 'PCR_GPA_high', 'GPA_ROE_low', 'ROA_NCAV_low', 'change_1_week_PER_low', 'change_1_week_change_12_month_low', 'change_1_month_change_3_month_high', 'change_1_day_PBR_high', 'GPA_ROA_high', 'ROE_ROA_low', 'change_1_week_PSR_high', 'PCR_change_3_month_low', 'PCR_change_6_month_high')
f3 = c('PER_NCAV_high', 'PER_PSR_high', 'PSR_ROE_low', 'change_1_month_PSR_high', 'change_1_week_PBR_high', 'change_1_month_ROA_high', 'PSR_ROA_high', 'PER_GPA_low', 'change_1_month_PSR_low', 'PBR_ROA_high', 'change_1_week_change_1_month_low', 'change_1_month_PER_high', 'GPA_change_3_month_low', 'change_1_day_PER_low', 'PER_PBR_high', 'ROE_NCAV_low', 'change_1_month_PER_low', 'GPA_ROE_high', 'change_1_month_ROE_high', 'PBR_change_12_month_high', 'change_1_week_PBR_low', 'change_1_week_GPA_low', 'change_1_day_PSR_low', 'PCR_ROE_low', 'change_1_month_ROE_low', 'PCR_ROA_high', 'change_1_month_GPA_low', 'PER_PBR_low', 'ROE_change_3_month_low', 'change_1_day_NCAV_high', 'PCR_GPA_low', 'PSR_GPA_low', 'PSR_change_6_month_high', 'PER_change_6_month_low', 'ROE_change_6_month_low', 'ROE_ROA_high', 'PBR_ROE_low', 'PSR_change_6_month_low', 'change_1_month_PBR_low', 'GPA_change_6_month_high', 'ROA_NCAV_high', 'change_1_day_change_6_month_low', 'GPA_NCAV_low', 'PSR_change_3_month_high', 'change_1_month_NCAV_low', 'change_1_day_PCR_high', 'ROE_change_12_month_low', 'GPA_ROA_low', 'PBR_PCR_high', 'ROE_change_12_month_high', 'change_1_month_PCR_high', 'change_1_day_change_1_week_high', 'change_1_day_ROA_high', 'change_1_week_PSR_low', 'change_1_day_ROE_high', 'PSR_PCR_low', 'PBR_change_12_month_low', 'change_1_month_PCR_low', 'PBR_change_6_month_high', 'change_1_month_GPA_high', 'change_1_week_change_3_month_high', 'PBR_ROE_high', 'change_1_week_PER_high', 'change_1_week_PCR_high', 'PER_ROE_high', 'PSR_change_3_month_low', 'change_1_month_change_12_month_high', 'GPA_NCAV_high', 'change_1_day_change_1_week_low', 'PER_PCR_high', 'PER_change_3_month_high', 'PER_change_6_month_high', 'change_1_week_change_12_month_high', 'change_1_week_change_6_month_low', 'PER_ROA_high', 'PER_ROE_low', 'PER_change_3_month_low', 'PCR_NCAV_high', 'change_1_day_GPA_low', 'PBR_PCR_low')
folderpaths = c(f1, f2, f3)


print(length(folderpaths))

# Load the package 
library("rjson")
library("corrgram")
library("stringr")

# Load the data
Growth <- data.frame(c(1:77))
namesets <- c("dates")

par(mfrow=c(6, 5), mar=c(0,0,0,0))

for(folderpath in folderpaths){
  factor <- fromJSON(file = paste("./",folderpath,"/factor.json", sep=""))
  second_factor <- fromJSON(file = paste("./",folderpath,"/second_factor.json", sep=""))
  
  test = cor.test(factor, second_factor, method="pearson")
  if (test$p.value > 0.5){
    # do nothing
  } else if (test$p.value > 0.05){
    plot(factor, second_factor, xlab='', ylab='', xaxt='n', yaxt='n', col='light blue')
  } else if (test$p.value > 0.01) {
    plot(factor, second_factor, xlab='', ylab='', xaxt='n', yaxt='n', col="blue")
  } else {
    plot(factor, second_factor, xlab='', ylab='', xaxt='n', yaxt='n', col="black")
  }
  
  if (T) {
  title_text=sub("high","H",sub("low","L",str_remove(sub("week","w",sub("day","d",sub("month","m",sub("month","m",str_remove(folderpath, "_change"))))),"change_")))
  print(title_text)
  title_text=paste(title_text, "cor:", sep="\n")
  title_text=paste(title_text, round(test$estimate, 5), sep=" ")
  title_text=paste(title_text, "p:", sep="\n")
  title_text=paste(title_text, test$p.value, sep=" ")
  title(title_text, line=-3, cex.main=1.1, col.main='red')
  }
  
}



